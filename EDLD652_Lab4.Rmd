---
title: "Untitled"
author: "Rachel Byers"
date: "2026-01-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, results = "hide")
options(repos=c(CRAN="https://cran.r-project.org"))
```
**Lab Setup**
```{r}
library(tidyverse)
library(palmerpenguins)
library(viridis)
library(RColorBrewer)
library(colorspace)
library(ggrepel)
library(colorblindr)
library(remotes)
library(gghighlight)
library(ggplot2)
```
# Part 1: Distinguishing Groups (Qualitative Color)
**1.1** Create a scatterplot showing bill length vs. bill depth, colored by species. Compare at least three different qualitative palettes:
```{r}
data(penguins)
summary(penguins)

LengthxBill1 <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Bill Length vs. Bill Depth by Species", x = "Bill Length", y = "Bill Depth") + scale_color_manual(values = c("Adelie" = "orange", "Chinstrap" = "blue", "Gentoo" = "#CC79A7")) + theme_minimal()

LengthxBill1

LengthxBill2 <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Scatterplot of Bill Length vs. Bill Depth by Species", x = "Bill Length", y = "Bill Depth") +
scale_color_brewer(palette = "Set2") + theme_bw()
LengthxBill2

LengthxBill3 <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Scatterplot of Bill Length vs. Bill Depth by Species", x = "Bill Length", y = "Bill Depth") +
scale_color_viridis_d(option = "plasma") + theme_bw()
LengthxBill3

LengthxBill4 <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Scatterplot of Bill Length vs. Bill Depth by Species", x = "Bill Length", y = "Bill Depth") +
scale_color_OkabeIto() + theme_bw()
LengthxBill4

```
**Reflection**
Out of the four color pallettes I tried, I think the first, LengthXBill1, is the best for this scenario. The three colors I chose for this plot are recommended by the readings for the course to be compatible with all forms of color blindness.  

**1.2** Create a boxplot of body mass by island. Use a colorblind-safe palette from ColorBrewer.
```{r}
RColorBrewer::display.brewer.all(colorblindFriendly = TRUE)
BodymassxIsland <- ggplot(data = penguins, aes(x = island, y = body_mass_g, col = island)) + labs(title = "Body Mass by Island", x = "Island", y = "Body Mass") + geom_boxplot() + scale_color_brewer(palette = "Dark2")
BodymassxIsland
cvd_grid(BodymassxIsland)
```
# Part 2: Representing Data Values (Sequential & Diverging)
```{r}
LengthxBodyMass1 <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = bill_length_mm)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Body Mass by Bill Length", x = "Flipper Length", y = "Body Mass") + scale_color_viridis_c(option = "inferno") + theme_minimal()
LengthxBodyMass1

LengthxBodyMass2 <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = bill_length_mm)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Body Mass by Bill Length", x = "Flipper Length", y = "Body Mass") + scale_color_distiller(palette = "YlOrRd") + theme_minimal()
LengthxBodyMass2

LengthxBodyMass3 <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = bill_length_mm)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Body Mass by Bill Length", x = "Flipper Length", y = "Body Mass") + scale_color_continuous_sequential(palette = "Heat") + theme_minimal()
LengthxBodyMass3
```
**Reflection**
I think the palette that makes it easiest to see the differences in bill length is the Inferno option, because the contrast is the greatest in that palette out of the three options.

**2.2** Calculate mean body mass by species and sex. Create a heatmap using geom_tile() with a diverging color scale.
```{r}
penguin_summary <- penguins %>%
  drop_na(sex) %>%
  group_by(species, sex) %>%
  summarize(mean_mass = mean(body_mass_g), .groups = "drop")

SpeciesHeatmap <- ggplot(penguin_summary, aes(species, sex)) +
  geom_tile(aes(fill = mean_mass), colour = "white") + labs(title = "Heatmap of Mean Body Mass", x = "Species", y = "Sex") +
  scale_fill_distiller(palette = "RdBu", direction = -1) +geom_text(aes(label = mean_mass))
SpeciesHeatmap
```






