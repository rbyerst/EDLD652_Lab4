---
title: "Untitled"
author: "Rachel Byers"
date: "2026-01-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, results = "hide")
options(repos=c(CRAN="https://cran.r-project.org"))
```
**Lab Setup**
```{r}
library(tidyverse)
library(palmerpenguins)
library(viridis)
library(RColorBrewer)
library(colorspace)
library(ggrepel)
library(colorblindr)
library(remotes)
library(gghighlight)
library(ggplot2)
```
# Part 1: Distinguishing Groups (Qualitative Color)
**1.1** Create a scatterplot showing bill length vs. bill depth, colored by species. Compare at least three different qualitative palettes:
```{r}
data(penguins)
summary(penguins)

LengthxBill1 <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Bill Length vs. Bill Depth by Species", x = "Bill Length", y = "Bill Depth") + scale_color_manual(values = c("Adelie" = "orange", "Chinstrap" = "blue", "Gentoo" = "#CC79A7")) + theme_minimal()

LengthxBill1

LengthxBill2 <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Scatterplot of Bill Length vs. Bill Depth by Species", x = "Bill Length", y = "Bill Depth") +
scale_color_brewer(palette = "Set2") + theme_bw()
LengthxBill2

LengthxBill3 <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Scatterplot of Bill Length vs. Bill Depth by Species", x = "Bill Length", y = "Bill Depth") +
scale_color_viridis_d(option = "plasma") + theme_bw()
LengthxBill3

LengthxBill4 <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Scatterplot of Bill Length vs. Bill Depth by Species", x = "Bill Length", y = "Bill Depth") +
scale_color_OkabeIto() + theme_bw()
LengthxBill4

```
**Reflection**
Out of the four color palettes I tried, I think the first, LengthXBill1, is the best for this scenario. The three colors I chose for this plot are recommended by the readings for the course to be compatible with all forms of color blindness.  

**1.2** Create a boxplot of body mass by island. Use a colorblind-safe palette from ColorBrewer.
```{r}
RColorBrewer::display.brewer.all(colorblindFriendly = TRUE)
BodymassxIsland <- ggplot(data = penguins, aes(x = island, y = body_mass_g, col = island)) + labs(title = "Body Mass by Island", x = "Island", y = "Body Mass") + geom_boxplot() + scale_color_brewer(palette = "Dark2")
BodymassxIsland
cvd_grid(BodymassxIsland)
```
# Part 2: Representing Data Values (Sequential & Diverging)
```{r}
LengthxBodyMass1 <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = bill_length_mm)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Body Mass by Bill Length", x = "Flipper Length", y = "Body Mass") + scale_color_viridis_c(option = "inferno") + theme_minimal()
LengthxBodyMass1

LengthxBodyMass2 <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = bill_length_mm)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Body Mass by Bill Length", x = "Flipper Length", y = "Body Mass") + scale_color_distiller(palette = "YlOrRd") + theme_minimal()
LengthxBodyMass2

LengthxBodyMass3 <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = bill_length_mm)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Body Mass by Bill Length", x = "Flipper Length", y = "Body Mass") + scale_color_continuous_sequential(palette = "Heat") + theme_minimal()
LengthxBodyMass3
```
**Reflection**
I think the palette that makes it easiest to see the differences in bill length is the Inferno option, because the contrast is the greatest in that palette out of the three options.

**2.2** Calculate mean body mass by species and sex. Create a heatmap using geom_tile() with a diverging color scale.
```{r}
penguin_summary <- penguins %>%
  drop_na(sex) %>%
  group_by(species, sex) %>%
  summarize(mean_mass = mean(body_mass_g), .groups = "drop")

SpeciesHeatmap <- ggplot(penguin_summary, aes(species, sex)) +
  geom_tile(aes(fill = mean_mass), colour = "white") + labs(title = "Heatmap of Mean Body Mass", x = "Species", y = "Sex") +
  scale_fill_distiller(palette = "RdBu", direction = -1) +geom_text(aes(label = mean_mass))
SpeciesHeatmap
```
# Part 3: Highlighting Specific Points
**3.1** Create a scatterplot of flipper length vs. bill length. Highlight only Gentoo penguins in a bright color; show all others in gray.
```{r}
FlipperxBill <- ggplot(penguins, aes(x = flipper_length_mm, y = bill_length_mm, color = species)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Bill Length by Species", x = "Flipper Length", y = "Bill Length") + scale_color_manual(values = c("Adelie" = "gray", "Chinstrap" = "gray", "Gentoo" = "#CC79A7")) + theme_minimal()
FlipperxBill

FlipperxBill2 <- ggplot(penguins, aes(x = flipper_length_mm, y = bill_length_mm, color = species)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Bill Length by Species", x = "Flipper Length", y = "Bill Length") + gghighlight(species == "Gentoo") + theme_minimal()
FlipperxBill2
```
**Reflection** 
Using the "scale_manual_color" approach seems to allow more control here, as you could be very specific with which color you want to use for the highlighting. 

**3.2** Create a line plot showing penguin counts by year and species. Highlight only Adelie penguins while keeping other species visible in gray.

```{r}
penguinscount <- penguins %>% count(year, species)
penguinscount <- as.data.frame(penguinscount)
penguinscount
CountxYear1 <- ggplot(penguinscount, aes(x = year, y = n)) + 
  geom_line(aes(color=species, size = 1.5))+
  scale_color_manual(name='Species', labels=c('Adelie', 'Chinstrap', 'Gentoo'),
                     values=c('red', 'gray', 'gray'))+ 
  labs(title = "Penguin Count by Year", x = "Year", y = "Count")+
  scale_x_continuous(breaks = seq(2007, 2009, by = 1))
CountxYear1

```
# Part 4: Accessibility Check
**4.1**  Take one of your plots from Part 1 or 2 and test it for colorblind accessibility.
```{r}
cvd_grid(LengthxBodyMass3)
UpdatedLengthxBodyMass3 <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = bill_length_mm)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Body Mass by Bill Length", x = "Flipper Length", y = "Body Mass") + scale_color_continuous_sequential(palette = "Blues") + theme_minimal()
UpdatedLengthxBodyMass3
```
**4.2** Demonstrate double encoding by creating a scatterplot that uses both color AND shape to distinguish groups.
```{r}
FlipperxBillDE <- ggplot(penguins, aes(x = flipper_length_mm, y = bill_length_mm, color = species, shape = species)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Flipper Length vs. Bill Length by Species", x = "Flipper Length", y = "Bill Length") + scale_color_brewer(palette = "Dark2") + theme_minimal()
FlipperxBillDE
```
**Reflection** 
Adding shape can help improve accessibility by increasing the distinction between groups. 
# Part 5: Avoiding Common Problems
**5.1** Create an example showing the “too many colors” problem, then fix it using selective highlighting and labels with geom_text_repel().
```{r}
summary(penguins)
FlipperxBillBad1 <- ggplot(penguins, aes(x = bill_length_mm, y = flipper_length_mm, color = flipper_length_mm)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Bill Length vs. Flipper Length", x = "Bill Length", y = "Flipper Length") + scale_color_gradientn(colors = c("red", "orange", "yellow", "green", "blue", "light blue", "violet", "pink", "white")) + theme_dark()
FlipperxBillBad1

FlipperxBillGood <- ggplot(penguins, aes(x = bill_length_mm, y = flipper_length_mm, color = species)) + geom_point(size = 3, alpha = 0.7) + labs(title = "Scatterplot of Bill Length vs. Flipper Length", x = "Bill Length", y = "Flipper Length") + scale_color_manual(name='Species', labels=c('Adelie', 'Chinstrap', 'Gentoo'),
                     values=c('orange', 'gray', 'gray')) + theme_minimal()
FlipperxBillGood
```
**5.2** 













